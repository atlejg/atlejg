#!/usr/bin/perl -w

#use Shell;
use File::Basename;

sub _usage
{
   return<<USAGE_END;
 usage: $0 datafile
  This creates a perl executable that is 
  easy to parametrize.
  Useful for datafiles like Eclipse
USAGE_END
}

$datafile = shift or die _usage();

$case = fileparse($datafile,'.DATA');

$perlfile = "$case.pl";

open FILE,     $datafile    || die "cannot open file : $!";
open PERLFILE, ">$perlfile" || die "cannot open file : $!";

# slurp datafile
@datafile = <FILE>;
close FILE;

print STDERR "$0: creating file $perlfile (from file $datafile)\n";

$perlbin = `which perl`;
chomp($perlbin);

print PERLFILE <<PERLIFY_END;
#!$perlbin -w
# autogenerated by $0 based on $datafile

# this  variable may be used freely in between the THE_END tokens
\$var1 = 0;

print <<THE_END;
PERLIFY_END

print PERLFILE @datafile;

print PERLFILE "\nTHE_END\n";

close PERLFILE;

#chmod 755, $perlfile; # doesnt work properly. why??
system("chmod 755 $perlfile");

